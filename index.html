<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/two.js/0.6.0/two.js"></script>
</head>

<body>
<script>
var back_color = 'white'
var beat_period = 100

var two = new Two({ fullscreen: true }).appendTo(document.body)

two.scene.scale = Math.min(two.width, two.height) / 1000.0
two.scene.translation.set(two.width/2.0, two.height/2.0)

var radius = 400
var circle = two.makeCircle(0, 0, radius)
circle.stroke = 'orangered'
circle.linewidth = 2

var beat_count = 16
var dots = []
for (var i = 0; i < beat_count; i++) {
	var dot = two.makeCircle(radius * Math.sin(Math.PI * 2 * i / beat_count), radius * Math.cos(Math.PI * 2 * i / beat_count), 40)
	dot.stroke = 'orangered'
	dot.fill = back_color
	dot.linewidth = 4
	dots.push(dot)
}

var elapsed = 0
var prev_beat_id

two.bind('update', (frame, delta) => {
    if (typeof(delta) === 'undefined') {
		elapsed = 0
	} else {
		elapsed += delta
	}
	
	beat_id = Math.floor(elapsed / beat_period) % beat_count
	
	if (typeof(prev_beat_id) === 'undefined' || prev_beat_id != beat_id) {
	
		for (var i = 0; i < beat_count; i++) {
			if (i == beat_id) {
				dots[beat_id].fill = "red"
				console.log("setting fill", dots[i], "to", dots[i].fill)
			} else {
				dots[beat_id].fill = back_color
			}
		}
		
		console.log(frame, delta, elapsed, beat_id, dots)
		
		prev_beat_id = beat_id
    }
})

two.update()
//two.play()

</script>
</body>
</html>